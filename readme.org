[[https://github.com/minad/corfu/blob/screenshots/emacs.svg?raw=true]]

* Citar-Denote: Literature notes in Denote
The Denote package provides a minimalist approach to creating and managing notes in Emacs. A note-taking system is often connected to a bibliographic database. Several Emacs packages are available that can link BibTeX files to notes.

The [[https://joostkremers.github.io/ebib/][Ebib]], [[https://github.com/tmalsburg/helm-bibtex][Helm-BibTeX and Ivy-BibTeX]] each use their own completion system. The [[https://github.com/emacs-citar/citar][Citar]] package is closest to the philosophy behind Denote as it uses minibuffer completion and integrates with the popular Vertico, Marginalia, Consult and Embark toolchain.

The /Citar-Denote/ package enables accessing and creating Denote notes through the Citar bibliography management package.

This code would not have existed without the help of Protesilaos Stavrou, developer of Denote, Citar developer  Avatar Bruce D'Arcus, Joel Lööw and Noboru Ota.

Please note that this package is still being prepared for production. I am an Elisp novice, so any assistance would be appreciated.

* Functionality
Please note that the Citar-Denote package only works with Org Mode Denotes files.

** Create bibliographic notes
Open the Citar interface (=citar-open=) and select the entry you like to create a note for. Then, hit =ENTER= and select the 'Create Denote Notes' option.

A new note is created in the Denote folder with the title of the BibTeX entry as the title as the default. You can select file tags with the usual Denote menu. The =bib= tag is added by default. This tag is required to easily find all notes related to a publication. The =citar-denote-keyword= variable allows you to change the tag to something else. If are using the package and like to change tags, you will have to update notes with the previous Citar keyword.

The package add the citation key to the front matter, e.g. =#+reference:  einstein_1905=. This line and the file tag link relate the note file to the BibTeX entry, and any change will result in breaking that link.

One note can only have one citation key, but each reference can have multiple notes. You could as such create a note about each chapter of a book.

** Access bibliographic notes
When opening the bibliography menu for the first time in an Emacs session, Citar checks all files tagged with the =citar-denote-keyword= and reads the relevant references. This can take a while if you have a lot of bibliographic notes. This initialisation creates a hash table for Citar.

When opening Citar, any file with a note is indicated with a flag in the second column. Filtering the list with =has:n= will show only entries with notes.

Hit enter and select the Denote Notes you like to open.

[[file:citar-menu.png]]

* Installation
Clone this page with =git clone https://github.com/pprevos/citar-denote= and add the following code to your =init= file:
- Add the location of the =citar-denote= folder to your path
- Activate the package
- Set the location where Citar can find notes to the Denote folder

#+begin_src elisp
  (add-to-list 'load-path "~/.config/emacs/github/citar-denote")
  (require 'citar-denote)
  (setq citar-notes-paths denote-directory)
#+end_src

* Todo
- [ ] Optimise the code so it does not keep open bibliography buffers upon startup.
- [ ] Streamline citation key extraction in =citar-denote--get-notes=
- [ ] Buttonise the citation key to open the entry in Citar.
- [ ] Store hash table to disk?
- [X] Provide the option to edit the title when creating a new note.
